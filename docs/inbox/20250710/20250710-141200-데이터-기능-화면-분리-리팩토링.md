# 데이터-기능-화면 분리 리팩토링

> 완벽히 FSD는 아냐 데이터 기능 화면 이 3가지를 분리하고 싶은 거지. 그래서 일단 그렇게 한번 리팩토링을 하려고

## 현재 상황 분석

### 3계층 분리 원칙
1. **데이터 (Data)** - 상태, 타입, 모델
2. **기능 (Logic)** - 비즈니스 로직, 액션, 변환
3. **화면 (View)** - UI 컴포넌트, 레이아웃

### 현재 구조에서 각 계층 매핑

```
src/lib/
├── base/                    # 핵심 인프라
│   ├── dom/                # DOM 유틸리티 (기능)
│   └── svelte-rx/         # 상태 관리 (데이터+기능)
├── entities/               # 데이터 계층
│   ├── editor/            # 에디터 데이터 모델
│   └── selection/         # 선택 영역 데이터 (store, types, actions 혼재)
├── features/              # 기능 계층
│   └── html-parser/       # HTML 파싱 기능
├── widgets/               # 화면 계층 (순수 UI)
├── modules/               # 화면 계층 (복합 UI)
└── *.svelte 파일들         # 화면 계층 (정리 필요)
```

## 리팩토링 계획

### 1단계: 루트의 .svelte 파일들 정리
현재 lib/ 루트에 있는 컴포넌트들:
- `EditOverlay.svelte` → widgets/ (재사용 가능한 UI)
- `HtmlEditor.svelte` → modules/ 또는 features/html-parser/
- 기타 .svelte 파일들 → 적절한 위치로 이동

### 2단계: entities/ 정리 (순수 데이터만)
- `selection/actions.ts` → features/selection/ 으로 이동
- `selection/selectionStore.ts` → 데이터 부분만 남기고 로직은 features로
- types.ts 파일들은 그대로 유지

### 3단계: features/ 강화 (기능 중심)
- 각 feature별로 actions, logic, utils 구성
- store의 비즈니스 로직 부분 이동
- 화면과 완전히 분리된 순수 기능

### 4단계: 화면 계층 체계화
- widgets/: 도메인 독립적 UI (Button, Modal, Overlay 등)
- modules/: 도메인 특화 UI (HtmlEditor, SelectionUI 등)
- layouts/: 페이지 레이아웃 (필요시 추가)

## 예상 결과 구조

```
src/lib/
├── base/                    # 인프라
├── entities/               # 순수 데이터 모델
│   ├── editor/            # types.ts만
│   └── selection/         # types.ts만
├── features/              # 비즈니스 로직
│   ├── html-parser/       # 파싱 로직
│   ├── selection/         # 선택 기능 (actions, logic)
│   └── editor/            # 에디터 기능
├── widgets/               # 재사용 UI
│   └── EditOverlay.svelte
├── modules/               # 복합 UI
│   └── HtmlEditor.svelte
└── stores/                # 전역 상태 (필요시)
```

## 장점
1. **명확한 책임 분리**: 데이터/기능/화면이 독립적
2. **테스트 용이성**: 기능을 UI 없이 테스트 가능
3. **재사용성**: 각 계층을 독립적으로 재사용
4. **유지보수성**: 변경 영향 범위가 명확

어떤 부분부터 시작하실까요? EditOverlay.svelte를 widgets/로 옮기는 것부터 시작할까요?