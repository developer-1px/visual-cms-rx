# scan vs map 패턴의 차이

## 현재 패턴 (map + 함수 반환)
```typescript
on(_증가하기).pipe(
  map(amount => (state: number) => state + amount)
)
```

## scan을 직접 사용할 경우의 문제
```typescript
on(_증가하기).pipe(
  scan((state, amount) => state + amount, 0)
)
```

### "stream이 상태를 가진다"는 의미

1. **각 스트림이 독립적인 상태를 유지**
   - `on(_증가하기).pipe(scan(..., 0))` → 자체 상태 0부터 시작
   - `on(_감소하기).pipe(scan(..., 0))` → 또 다른 상태 0부터 시작
   - `on(_리셋하기).pipe(scan(..., 0))` → 또 다른 상태 0부터 시작

2. **문제 예시**
   ```
   dispatch(_증가하기(5))  // 증가하기 스트림: 0 + 5 = 5
   dispatch(_감소하기(2))  // 감소하기 스트림: 0 - 2 = -2 (5가 아닌 0에서 시작!)
   ```

3. **현재 패턴이 작동하는 이유**
   - 모든 액션이 함수를 반환 → `merge(...streams)` 후에 → 하나의 `scan`에서 처리
   - 단일 상태만 존재하고, 모든 액션이 그 상태를 변경

## 결론
- 각 액션 스트림이 독립적인 scan을 가지면 상태가 분리됨
- 중앙집중식 상태 관리를 위해서는 현재 패턴(map + 함수 반환)이 필수
- 약간의 보일러플레이트가 있지만, 이는 상태 일관성을 위한 필요악